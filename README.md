# Sender-Messages
Тестовое задание для 404 group

Приложение позволяет отправлять и созранять сообщения через  REST.

При любом запросе происходит авторизация по токену, его нуждно передавать в headers

**Для постановки сообщений в очередь** отправляйте методом post на http://127.0.0.1:8000/sendMessage.
Данные должны быть такого формата в виде json'a

{
 "users": [
 	{
 	"chat_id": 111,
 	"messenger_id": 1
 	},
 	{
     "chat_id": 2,
 		"messenger_id": 2
     }
 ],
 "message": "test message1",
}

**Для немедленной отправки сообщений** минуя очередь добавьте флаг `"send_now": true` вот так:
<br/>
```
{
 "users": [
 	{
 	"chat_id": 111,
 	"messenger_id": 1
 	},
 	{
     "chat_id": 2,
 		"messenger_id": 2
     }
 ],
 "message": "test message1",
 "send_now": true
}
```
**Для разбора очереди сообщений** нужно поставить в крон такой метод http://127.0.0.1:8000/parseQueue

**Статус доставки сообщения** происходит через вызов callback'a http://127.0.0.1:8000/callBackFromMessenger и отправки туда данных в формате json
<br/>
```
{
	"statusData" : [
		{
		"chat_id" : 1,
		"status" : false,
		"messenger_id" : 1,
		"message" : "text"
		},
		{
			"chat_id" : 111,
			"status" : true,
			"messenger_id" : 1,
			"message" : "test message"
		}
	]
}```
<br/>
В нем происходит обновление статуса доставки сообщения или повторная отправка сообщения, если оно не было доставлено

Для корректной работы нужно произвести такие настройки:<br/>
-установить нужный порт и хост для редиса тут src/Redis/Redis.php <br/>
-установить порт, хост и имя базы данных тут .env


